{"version":3,"file":"pey-unified-notifications.js.map","sources":["ng://pey-unified-notifications/lib/services/notifications/mobile-firebase-messaging.service.ts","ng://pey-unified-notifications/lib/services/notifications/web-firebase-messaging.service.ts","ng://pey-unified-notifications/lib/services/notifications/unified-firebase-messaging.service.ts","ng://pey-unified-notifications/lib/guards/ios-push-permission.guard.ts","ng://pey-unified-notifications/lib/pey-unified-notifications.component.ts","ng://pey-unified-notifications/lib/pey-unified-notifications.module.ts"],"sourcesContent":["import { Injectable, OnDestroy } from '@angular/core';\r\nimport { BehaviorSubject, Subject } from 'rxjs';\r\n\r\n// declare var FirebasePlugin;\r\nimport { Firebase } from '@ionic-native/firebase/ngx';\r\nimport { takeWhile } from 'rxjs/operators';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class MobileFirebaseMessagingService implements OnDestroy {\r\n\r\n  permission = new BehaviorSubject<boolean>(null);\r\n  token = new BehaviorSubject<string>(null);\r\n\r\n  currentMessage = new BehaviorSubject(null);\r\n\r\n  isAlive = true;\r\n\r\n  constructor(\r\n    private firebase: Firebase\r\n  ) { }\r\n\r\n  ngOnDestroy() {\r\n    this.isAlive = false;\r\n  }\r\n  init() {\r\n    this.getToken();\r\n    this.initNotifications();\r\n  }\r\n  getToken() { \r\n    this.firebase.getToken()\r\n        .then( token => {\r\n          this.token.next(token);\r\n        })\r\n        .catch(err => console.log(err));\r\n\r\n    this.firebase.onTokenRefresh()\r\n      .pipe(takeWhile(() => this.isAlive))\r\n      .subscribe( x => {\r\n        //posts on update\r\n        if(x) {\r\n          if(x !== this.token) {\r\n            this.token.next(x);\r\n          }\r\n        }\r\n      });\r\n  }\r\n  initNotifications() { \r\n    this.firebase.onNotificationOpen()\r\n      .pipe(takeWhile(() => this.isAlive))\r\n      .subscribe( notification => {\r\n          this.currentMessage.next(notification);\r\n      });\r\n  }\r\n  joinGroup(id: string) {\r\n    console.log('subscribe to group' + id);\r\n    this.firebase.subscribe(id);\r\n  }\r\n  leaveGroup(id: string) {\r\n    console.log('unsubscribe to group' + id);\r\n    this.firebase.unsubscribe(id);\r\n  }\r\n  updatePermission() {\r\n    this.firebase.grantPermission()\r\n      .then(permission => {\r\n        this.permission.next(permission);\r\n      })\r\n      .catch(err => console.log(err));\r\n    this.firebase.hasPermission()\r\n      .then(perm =>  {\r\n        console.log('permission');\r\n        console.log(perm);\r\n      })\r\n      .catch(err => console.log(err));\r\n  }\r\n  hasPermission(): Promise<boolean> {\r\n    return this.firebase.hasPermission()\r\n              .then(perm => {\r\n                return perm.isEnabled;\r\n              });\r\n  }\r\n}","import { Injectable, OnDestroy } from '@angular/core';\nimport { AngularFireMessaging } from '@angular/fire/messaging';\nimport { takeWhile } from 'rxjs/operators';\nimport { BehaviorSubject, Subject } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class WebFirebaseMessagingService implements OnDestroy{\n\n    permission = new BehaviorSubject<boolean>(null);\n    token = new BehaviorSubject<string>(null);\n    currentMessage = new BehaviorSubject(null);\n\n    isAlive= true;\n    isActive = false;\n\n  constructor(\n    private angularFireMessaging: AngularFireMessaging) {\n      console.log('web');\n  }\n    ngOnDestroy() { console.log('webdead');\n        this.isAlive = false;\n        this.isActive = false;\n    }\n  init() {\n\n    this.angularFireMessaging.messaging.pipe(takeWhile(() => this.isAlive)).subscribe(\n      (_messaging) => {\n        _messaging.onMessage = _messaging.onMessage.bind(_messaging);\n        _messaging.onTokenRefresh = _messaging.onTokenRefresh.bind(_messaging);\n      } \n    );\n    // this.getToken();\n    this.receiveMessage(); \n  }\n  //on web getting the token means asking for permission\n  updatePermission() {\n    this.getToken();\n  }\n  getToken() {\n    this.angularFireMessaging.requestToken\n        .pipe(takeWhile(() => this.isAlive))\n        .subscribe(\n            (token) => {\n                this.token.next(token);\n                this.permission.next(true);\n            },\n            (err) => {\n                console.error('Unable to get permission to notify.', err);\n            }\n        );\n      return true;\n  }\n  receiveMessage() {\n    this.angularFireMessaging.messages\n        .pipe(takeWhile(() => this.isAlive))\n        .subscribe((payload) => {\n                this.currentMessage.next(payload);\n        });\n  }\n  onTokenRefresh() {\n      this.angularFireMessaging.tokenChanges\n        .pipe(takeWhile(() => this.isAlive))\n        .subscribe(token => {\n            this.token.next(token);\n        })\n  }\n\n}\n","import { Injectable, Inject } from '@angular/core';\r\nimport { MobileFirebaseMessagingService } from './mobile-firebase-messaging.service';\r\n// import { WebFirebaseMessagingService } from './web-firebase-messaging.service';\r\nimport { BehaviorSubject, Subject, observable } from 'rxjs';\r\n\r\nimport { PlatformHelperService } from './../helpers/platform-helper.service';\r\nimport { Platform } from '@ionic/angular';\r\nimport { WebFirebaseMessagingService } from './web-firebase-messaging.service';\r\nimport { takeWhile } from 'rxjs/operators';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class UnifiedFirebaseMessagingService {\r\n\r\n  // currentMessage = new Subject();\r\n  currentMessage =   new BehaviorSubject(null);\r\n  token = new BehaviorSubject<string>(null);\r\n  IsActive = false;\r\n  isAlive = true;\r\n  isNative: boolean;\r\n  //  only relevant on ios\r\n  permission = new BehaviorSubject(null);\r\n\r\n  constructor(\r\n    private mobileNotifications: MobileFirebaseMessagingService,\r\n    private webNotifications: WebFirebaseMessagingService,\r\n    // private platformHelper: PlatformHelperService,\r\n    private platformService: Platform\r\n\r\n  ) {\r\n  }\r\n\r\n  init(isNative: boolean) {\r\n    this.isNative = isNative;\r\n\r\n    if (isNative) {\r\n      this.mobileNotifications.init();\r\n      this.currentMessage = this.mobileNotifications.currentMessage;\r\n      this.permission = this.mobileNotifications.permission;\r\n      this.token = this.mobileNotifications.token;\r\n    } else {\r\n      this.webNotifications.init();\r\n      this.currentMessage = this.webNotifications.currentMessage;\r\n      this.token = this.webNotifications.token;\r\n      this.permission = this.webNotifications.permission;\r\n    }\r\n    this.IsActive = true;\r\n  }\r\n\r\n  joinGroup(id: string) {\r\n    if(this.isNative) {\r\n      this.mobileNotifications.joinGroup(id);\r\n    } else {\r\n      console.log('web topic/group subscriptions have to be resolved serverside');\r\n    }\r\n  }\r\n  leaveGroup(id: string) {\r\n    if(this.isNative) {\r\n      this.mobileNotifications.leaveGroup(id);\r\n    } else {\r\n      console.log('web topic/group subscriptions have to be resolved serverside');\r\n    }\r\n  }\r\n\r\n  updatePermission() {\r\n    if(this.isNative) {\r\n      this.mobileNotifications.updatePermission();\r\n    } else {\r\n      this.webNotifications.getToken();\r\n    }\r\n  }\r\n  // only works on iOS other platforms dont need permissions\r\n  hasPermission(): Promise<boolean> {\r\n    if(this.platformService.is('ios') && this.isNative) {\r\n      return this.mobileNotifications.hasPermission()\r\n        .then(res => { console.log(res);\r\n          return res;\r\n        });\r\n    } {\r\n      return new Promise<boolean>(() => {\r\n        return true;\r\n      });\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\nimport { CanActivate, ActivatedRouteSnapshot, RouterStateSnapshot } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { UnifiedFirebaseMessagingService } from '../services/notifications/unified-firebase-messaging.service';\nimport { Platform } from '@ionic/angular';\nimport { Dialogs } from '@ionic-native/dialogs/ngx';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class IosPushNotificationPermissiongGuard implements CanActivate {\n\n  constructor\n  (\n    private platformService: Platform,\n    private dialogs: Dialogs,\n    private unifiedNotificationService: UnifiedFirebaseMessagingService\n  ) { }\n  canActivate(\n    next: ActivatedRouteSnapshot,\n    state: RouterStateSnapshot): Observable<boolean> | Promise<boolean> | boolean {\n    if(!this.platformService.is('ios') ) {\n      return true;\n    }\n    return this.unifiedNotificationService.hasPermission().then(res => {\n      if(res) {\n        return true;        \n      } else {\n        return this.dialogs.alert\n        (\n          'This app requires push notifications to work as intended.\\nYou can turn them silent any time you want.',\n          'Important'\n        )\n        .then(() => {\n          this.unifiedNotificationService.updatePermission();  \n          return true;\n        })\n        .catch(e => {\n          console.log(e);\n          return true;\n        });\n      }\n    });\n    return false;\n  }\n}\n","import { Component, OnInit } from '@angular/core';\n// import { Dialogs } from '@ionic-native/dialogs/ngx';\n\n@Component({\n  selector: 'lib-pey-unified-notifications',\n  template: `\n    <p>\n      pey-unified-notifications works!\n    </p>\n  `,\n  styles: []\n})\nexport class PeyUnifiedNotificationsComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n  // dialogMe() {\n    \n  //   this.dialogs.alert\n  //   (\n  //     '\\LOREM IPSUM MY DUDE\\nSSSS\\n!?'     \n  //   )\n  //   .catch(e => console.log(e));\n  // }\n}\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { PeyUnifiedNotificationsComponent } from './pey-unified-notifications.component';\nimport { Dialogs } from '@ionic-native/dialogs/ngx';\nimport { Firebase } from '@ionic-native/firebase/ngx';\n\n\n@NgModule({\n  declarations: [PeyUnifiedNotificationsComponent],\n  imports: [\n  ],\n  exports: [PeyUnifiedNotificationsComponent],\n  providers: [\n    Dialogs,\n    Firebase\n  ]\n})\nexport class PeyUnifiedNotificationsModule {  }"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,MAWa,8BAA8B;;;;IASzC,YACU,QAAkB;QAAlB,aAAQ,GAAR,QAAQ,CAAU;QAR5B,eAAU,GAAG,IAAI,eAAe,CAAU,IAAI,CAAC,CAAC;QAChD,UAAK,GAAG,IAAI,eAAe,CAAS,IAAI,CAAC,CAAC;QAE1C,mBAAc,GAAG,IAAI,eAAe,CAAC,IAAI,CAAC,CAAC;QAE3C,YAAO,GAAG,IAAI,CAAC;KAIV;;;;IAEL,WAAW;QACT,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;KACtB;;;;IACD,IAAI;QACF,IAAI,CAAC,QAAQ,EAAE,CAAC;QAChB,IAAI,CAAC,iBAAiB,EAAE,CAAC;KAC1B;;;;IACD,QAAQ;QACN,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE;aACnB,IAAI,CAAE,KAAK;YACV,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SACxB,CAAC;aACD,KAAK,CAAC,GAAG,IAAI,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;QAEpC,IAAI,CAAC,QAAQ,CAAC,cAAc,EAAE;aAC3B,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,OAAO,CAAC,CAAC;aACnC,SAAS,CAAE,CAAC;;YAEX,IAAG,CAAC,EAAE;gBACJ,IAAG,CAAC,KAAK,IAAI,CAAC,KAAK,EAAE;oBACnB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;iBACpB;aACF;SACF,CAAC,CAAC;KACN;;;;IACD,iBAAiB;QACf,IAAI,CAAC,QAAQ,CAAC,kBAAkB,EAAE;aAC/B,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,OAAO,CAAC,CAAC;aACnC,SAAS,CAAE,YAAY;YACpB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;SAC1C,CAAC,CAAC;KACN;;;;;IACD,SAAS,CAAC,EAAU;QAClB,OAAO,CAAC,GAAG,CAAC,oBAAoB,GAAG,EAAE,CAAC,CAAC;QACvC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;KAC7B;;;;;IACD,UAAU,CAAC,EAAU;QACnB,OAAO,CAAC,GAAG,CAAC,sBAAsB,GAAG,EAAE,CAAC,CAAC;QACzC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;KAC/B;;;;IACD,gBAAgB;QACd,IAAI,CAAC,QAAQ,CAAC,eAAe,EAAE;aAC5B,IAAI,CAAC,UAAU;YACd,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SAClC,CAAC;aACD,KAAK,CAAC,GAAG,IAAI,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;QAClC,IAAI,CAAC,QAAQ,CAAC,aAAa,EAAE;aAC1B,IAAI,CAAC,IAAI;YACR,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;YAC1B,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;SACnB,CAAC;aACD,KAAK,CAAC,GAAG,IAAI,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;KACnC;;;;IACD,aAAa;QACX,OAAO,IAAI,CAAC,QAAQ,CAAC,aAAa,EAAE;aACzB,IAAI,CAAC,IAAI;YACR,OAAO,IAAI,CAAC,SAAS,CAAC;SACvB,CAAC,CAAC;KACd;;;YA1EF,UAAU,SAAC;gBACV,UAAU,EAAE,MAAM;aACnB;;;;YANQ,QAAQ;;;;;;;;ACJjB,MAQa,2BAA2B;;;;IAStC,YACU,oBAA0C;QAA1C,yBAAoB,GAApB,oBAAoB,CAAsB;QARlD,eAAU,GAAG,IAAI,eAAe,CAAU,IAAI,CAAC,CAAC;QAChD,UAAK,GAAG,IAAI,eAAe,CAAS,IAAI,CAAC,CAAC;QAC1C,mBAAc,GAAG,IAAI,eAAe,CAAC,IAAI,CAAC,CAAC;QAE3C,YAAO,GAAE,IAAI,CAAC;QACd,aAAQ,GAAG,KAAK,CAAC;QAIf,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;KACtB;;;;IACC,WAAW;QAAK,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QACnC,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACrB,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;KACzB;;;;IACH,IAAI;QAEF,IAAI,CAAC,oBAAoB,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,SAAS,CAC/E,CAAC,UAAU;YACT,UAAU,CAAC,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAC7D,UAAU,CAAC,cAAc,GAAG,UAAU,CAAC,cAAc,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SACxE,CACF,CAAC;;QAEF,IAAI,CAAC,cAAc,EAAE,CAAC;KACvB;;;;;IAED,gBAAgB;QACd,IAAI,CAAC,QAAQ,EAAE,CAAC;KACjB;;;;IACD,QAAQ;QACN,IAAI,CAAC,oBAAoB,CAAC,YAAY;aACjC,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,OAAO,CAAC,CAAC;aACnC,SAAS,CACN,CAAC,KAAK;YACF,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACvB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC9B,EACD,CAAC,GAAG;YACA,OAAO,CAAC,KAAK,CAAC,qCAAqC,EAAE,GAAG,CAAC,CAAC;SAC7D,CACJ,CAAC;QACJ,OAAO,IAAI,CAAC;KACf;;;;IACD,cAAc;QACZ,IAAI,CAAC,oBAAoB,CAAC,QAAQ;aAC7B,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,OAAO,CAAC,CAAC;aACnC,SAAS,CAAC,CAAC,OAAO;YACX,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACzC,CAAC,CAAC;KACR;;;;IACD,cAAc;QACV,IAAI,CAAC,oBAAoB,CAAC,YAAY;aACnC,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,OAAO,CAAC,CAAC;aACnC,SAAS,CAAC,KAAK;YACZ,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC1B,CAAC,CAAA;KACP;;;YA9DF,UAAU,SAAC;gBACV,UAAU,EAAE,MAAM;aACnB;;;;YANQ,oBAAoB;;;;;;;;ACD7B,MAca,+BAA+B;;;;;;IAW1C,YACU,mBAAmD,EACnD,gBAA6C,EAE7C,eAAyB;QAHzB,wBAAmB,GAAnB,mBAAmB,CAAgC;QACnD,qBAAgB,GAAhB,gBAAgB,CAA6B;QAE7C,oBAAe,GAAf,eAAe,CAAU;;QAZnC,mBAAc,GAAK,IAAI,eAAe,CAAC,IAAI,CAAC,CAAC;QAC7C,UAAK,GAAG,IAAI,eAAe,CAAS,IAAI,CAAC,CAAC;QAC1C,aAAQ,GAAG,KAAK,CAAC;QACjB,YAAO,GAAG,IAAI,CAAC;;QAGf,eAAU,GAAG,IAAI,eAAe,CAAC,IAAI,CAAC,CAAC;KAStC;;;;;IAED,IAAI,CAAC,QAAiB;QACpB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAEzB,IAAI,QAAQ,EAAE;YACZ,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,CAAC;YAChC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,mBAAmB,CAAC,cAAc,CAAC;YAC9D,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,mBAAmB,CAAC,UAAU,CAAC;YACtD,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC;SAC7C;aAAM;YACL,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC;YAC7B,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,gBAAgB,CAAC,cAAc,CAAC;YAC3D,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC;YACzC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC;SACpD;QACD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;KACtB;;;;;IAED,SAAS,CAAC,EAAU;QAClB,IAAG,IAAI,CAAC,QAAQ,EAAE;YAChB,IAAI,CAAC,mBAAmB,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;SACxC;aAAM;YACL,OAAO,CAAC,GAAG,CAAC,8DAA8D,CAAC,CAAC;SAC7E;KACF;;;;;IACD,UAAU,CAAC,EAAU;QACnB,IAAG,IAAI,CAAC,QAAQ,EAAE;YAChB,IAAI,CAAC,mBAAmB,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;SACzC;aAAM;YACL,OAAO,CAAC,GAAG,CAAC,8DAA8D,CAAC,CAAC;SAC7E;KACF;;;;IAED,gBAAgB;QACd,IAAG,IAAI,CAAC,QAAQ,EAAE;YAChB,IAAI,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,CAAC;SAC7C;aAAM;YACL,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,CAAC;SAClC;KACF;;;;;IAED,aAAa;QACX,IAAG,IAAI,CAAC,eAAe,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,QAAQ,EAAE;YAClD,OAAO,IAAI,CAAC,mBAAmB,CAAC,aAAa,EAAE;iBAC5C,IAAI,CAAC,GAAG;gBAAM,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;gBAC9B,OAAO,GAAG,CAAC;aACZ,CAAC,CAAC;SACN;QAAC;YACA,OAAO,IAAI,OAAO,CAAU;gBAC1B,OAAO,IAAI,CAAC;aACb,CAAC,CAAC;SACJ;KACF;;;YA1EF,UAAU,SAAC;gBACV,UAAU,EAAE,MAAM;aACnB;;;;YAZQ,8BAA8B;YAM9B,2BAA2B;YAD3B,QAAQ;;;;;;;;ACNjB,MAUa,mCAAmC;;;;;;IAE9C,YAEU,eAAyB,EACzB,OAAgB,EAChB,0BAA2D;QAF3D,oBAAe,GAAf,eAAe,CAAU;QACzB,YAAO,GAAP,OAAO,CAAS;QAChB,+BAA0B,GAA1B,0BAA0B,CAAiC;KAChE;;;;;;IACL,WAAW,CACT,IAA4B,EAC5B,KAA0B;QAC1B,IAAG,CAAC,IAAI,CAAC,eAAe,CAAC,EAAE,CAAC,KAAK,CAAC,EAAG;YACnC,OAAO,IAAI,CAAC;SACb;QACD,OAAO,IAAI,CAAC,0BAA0B,CAAC,aAAa,EAAE,CAAC,IAAI,CAAC,GAAG;YAC7D,IAAG,GAAG,EAAE;gBACN,OAAO,IAAI,CAAC;aACb;iBAAM;gBACL,OAAO,IAAI,CAAC,OAAO,CAAC,KAAK,CAEvB,wGAAwG,EACxG,WAAW,CACZ;qBACA,IAAI,CAAC;oBACJ,IAAI,CAAC,0BAA0B,CAAC,gBAAgB,EAAE,CAAC;oBACnD,OAAO,IAAI,CAAC;iBACb,CAAC;qBACD,KAAK,CAAC,CAAC;oBACN,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;oBACf,OAAO,IAAI,CAAC;iBACb,CAAC,CAAC;aACJ;SACF,CAAC,CAAC;QACH,OAAO,KAAK,CAAC;KACd;;;YArCF,UAAU,SAAC;gBACV,UAAU,EAAE,MAAM;aACnB;;;;YALQ,QAAQ;YACR,OAAO;YAFP,+BAA+B;;;;;;;;ACHxC;AAYA,MAAa,gCAAgC;IAE3C,iBAAiB;;;;IAEjB,QAAQ;KACP;;;YAdF,SAAS,SAAC;gBACT,QAAQ,EAAE,+BAA+B;gBACzC,QAAQ,EAAE;;;;GAIT;aAEF;;;;;;;;;ACXD,MAgBa,6BAA6B;;;YAVzC,QAAQ,SAAC;gBACR,YAAY,EAAE,CAAC,gCAAgC,CAAC;gBAChD,OAAO,EAAE,EACR;gBACD,OAAO,EAAE,CAAC,gCAAgC,CAAC;gBAC3C,SAAS,EAAE;oBACT,OAAO;oBACP,QAAQ;iBACT;aACF;;;;;;;;;;;;;;;"}
