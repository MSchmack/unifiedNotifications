{"version":3,"file":"pey-unified-notifications.umd.js.map","sources":["ng://pey-unified-notifications/lib/services/notifications/mobile-firebase-messaging.service.ts","ng://pey-unified-notifications/lib/services/helpers/platform-helper.service.ts","ng://pey-unified-notifications/lib/services/notifications/web-firebase-messaging.service.ts","ng://pey-unified-notifications/lib/services/notifications/unified-firebase-messaging.service.ts","ng://pey-unified-notifications/lib/guards/ios-push-permission.guard.ts","ng://pey-unified-notifications/lib/pey-unified-notifications.component.ts","ng://pey-unified-notifications/lib/pey-unified-notifications.module.ts"],"sourcesContent":["import { Injectable, OnDestroy } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\n// declare var FirebasePlugin;\r\nimport { Firebase } from '@ionic-native/firebase/ngx';\r\nimport { takeWhile } from 'rxjs/operators';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class MobileFirebaseMessagingService implements OnDestroy {\r\n\r\n  permission = new BehaviorSubject<boolean>(null);\r\n  token = new BehaviorSubject<string>(null);\r\n\r\n  currentMessage = new BehaviorSubject(null);\r\n\r\n  isAlive = true;\r\n\r\n  constructor(\r\n    private firebase: Firebase\r\n  ) { }\r\n\r\n  ngOnDestroy() {\r\n    this.isAlive = false;\r\n  }\r\n  init() {\r\n    this.getToken();\r\n    this.initNotifications();\r\n  }\r\n  getToken() { \r\n    this.firebase.getToken()\r\n        .then( token => {\r\n          this.token.next(token);\r\n        })\r\n        .catch(err => console.log(err));\r\n\r\n    this.firebase.onTokenRefresh()\r\n      .pipe(takeWhile(() => this.isAlive))\r\n      .subscribe( x => {\r\n        //posts on update\r\n        if(x) {\r\n          if(x !== this.token) {\r\n            this.token.next(x);\r\n          }\r\n        }\r\n      });\r\n  }\r\n  initNotifications() { \r\n    this.firebase.onNotificationOpen()\r\n      .pipe(takeWhile(() => this.isAlive))\r\n      .subscribe( notification => {\r\n          this.currentMessage.next(notification);\r\n      });\r\n  }\r\n  joinGroup(id: string) {\r\n    console.log('subscribe to group' + id);\r\n    this.firebase.subscribe(id);\r\n  }\r\n  leaveGroup(id: string) {\r\n    console.log('unsubscribe to group' + id);\r\n    this.firebase.unsubscribe(id);\r\n  }\r\n  updatePermission() {\r\n    this.firebase.grantPermission()\r\n      .then(permission => {\r\n        this.permission.next(permission);\r\n      })\r\n      .catch(err => console.log(err));\r\n    this.firebase.hasPermission()\r\n      .then(perm =>  {\r\n        console.log('permission');\r\n        console.log(perm);\r\n      })\r\n      .catch(err => console.log(err));\r\n  }\r\n  hasPermission(): Promise<boolean> {\r\n    return this.firebase.hasPermission()\r\n              .then(perm => {\r\n                return perm.isEnabled;\r\n              });\r\n  }\r\n}","\n\nimport { Injectable } from '@angular/core';\nimport { Platform } from '@ionic/angular';\n@Injectable({\n    providedIn: 'root'\n})\nexport class PlatformHelperService {\n\n    constructor(private platformService: Platform) { }\n\n    get isNative(): boolean {\n        //if http://local like in prod build & ios or android\n        // solution till platform.is('mobile') fixed\n        // return true;\n        if(\n            // (document.URL.indexOf( 'http://localhost') !== -1) &&\n            (window.hasOwnProperty('cordova')) &&\n            (this.platformService.is('ios') || this.platformService.is('android') )\n         ) {\n            return true;\n        } else {\n            return false;\n        }         \n    }\n}\n","import { Injectable, OnDestroy } from '@angular/core';\nimport { AngularFireMessaging } from '@angular/fire/messaging';\nimport { takeWhile } from 'rxjs/operators';\nimport { BehaviorSubject } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class WebFirebaseMessagingService implements OnDestroy{\n\n    permission = new BehaviorSubject<boolean>(null);\n    token = new BehaviorSubject<string>(null);\n    currentMessage = new BehaviorSubject(null);\n\n    isAlive= true;\n\n  constructor(\n    private angularFireMessaging: AngularFireMessaging) {\n\n  }\n    ngOnDestroy() {\n        this.isAlive = false;\n    }\n  init() {\n    this.angularFireMessaging.messaging.subscribe(\n      (_messaging) => {\n        _messaging.onMessage = _messaging.onMessage.bind(_messaging);\n        _messaging.onTokenRefresh = _messaging.onTokenRefresh.bind(_messaging);\n      }\n    );\n    // this.getToken();\n    this.receiveMessage(); \n  }\n  //on web getting the token means asking for permission\n  updatePermission() {\n      this.getToken();\n  }\n  getToken() {\n    this.angularFireMessaging.requestToken\n        .pipe(takeWhile(() => this.isAlive))\n        .subscribe(\n            (token) => {\n                this.token.next(token);\n                this.permission.next(true);\n            },\n            (err) => {\n                console.error('Unable to get permission to notify.', err);\n            }\n        );\n  }\n  receiveMessage() {\n    this.angularFireMessaging.messages\n        .pipe(takeWhile(() => this.isAlive))\n        .subscribe((payload) => {\n                this.currentMessage.next(payload);\n        });\n  }\n  onTokenRefresh() {\n      this.angularFireMessaging.tokenChanges\n        .pipe(takeWhile(() => this.isAlive))\n        .subscribe(token => {\n            this.token.next(token);\n        })\n  }\n\n}\n","import { Injectable, Inject } from '@angular/core';\r\nimport { MobileFirebaseMessagingService } from './mobile-firebase-messaging.service';\r\n// import { WebFirebaseMessagingService } from './web-firebase-messaging.service';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\nimport { PlatformHelperService } from './../helpers/platform-helper.service';\r\nimport { Platform } from '@ionic/angular';\r\nimport { WebFirebaseMessagingService } from './web-firebase-messaging.service';\r\nimport { initDomAdapter } from '@angular/platform-browser/src/browser';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class UnifiedFirebaseMessagingService {\r\n\r\n  currentMessage = new BehaviorSubject(null);\r\n  token = new BehaviorSubject<string>(null);\r\n  IsActive = false;\r\n\r\n  //  only relevant on ios\r\n  permission = new BehaviorSubject(null);\r\n\r\n  constructor(\r\n    private mobileNotifications: MobileFirebaseMessagingService,\r\n    private webNotifications: WebFirebaseMessagingService,\r\n    private platformHelper: PlatformHelperService,\r\n    private platformService: Platform\r\n\r\n  ) {  \r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    if (this.platformHelper.isNative) {\r\n      this.mobileNotifications.init();\r\n      this.currentMessage = this.mobileNotifications.currentMessage;\r\n      this.permission = this.mobileNotifications.permission;\r\n      this.token = this.mobileNotifications.token;\r\n    } else {\r\n      this.webNotifications.init();\r\n      this.currentMessage = this.webNotifications.currentMessage;\r\n      this.token = this.webNotifications.token;\r\n      this.permission = this.webNotifications.permission;\r\n    }\r\n    this.IsActive = true;\r\n  }\r\n\r\n  joinGroup(id: string) {\r\n    if(this.platformHelper.isNative) {\r\n      this.mobileNotifications.joinGroup(id);\r\n    } else {\r\n      console.log('web topic/group subscriptions have to be resolved serverside');\r\n    }\r\n  }\r\n  leaveGroup(id: string) {\r\n    if(this.platformHelper.isNative) {\r\n      this.mobileNotifications.leaveGroup(id);\r\n    } else {\r\n      console.log('web topic/group subscriptions have to be resolved serverside');\r\n    }\r\n  }\r\n\r\n  updatePermission() {\r\n    if(this.platformHelper.isNative) {\r\n      this.mobileNotifications.updatePermission();\r\n    } else {\r\n      this.webNotifications.getToken();\r\n    }\r\n  }\r\n  // only works on iOS other platforms dont need permissions\r\n  hasPermission(): Promise<boolean> {\r\n    if(this.platformService.is('ios') && this.platformHelper.isNative) {\r\n      return this.mobileNotifications.hasPermission()\r\n        .then(res => { console.log(res);\r\n          return res;\r\n        });\r\n    } {\r\n      return new Promise<boolean>(() => {\r\n        return true;\r\n      });\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\nimport { CanActivate, ActivatedRouteSnapshot, RouterStateSnapshot } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { UnifiedFirebaseMessagingService } from '../services/notifications/unified-firebase-messaging.service';\nimport { Platform } from '@ionic/angular';\nimport { Dialogs } from '@ionic-native/dialogs/ngx';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class IosPushNotificationPermissiongGuard implements CanActivate {\n\n  constructor\n  (\n    private platformService: Platform,\n    private dialogs: Dialogs,\n    private unifiedNotificationService: UnifiedFirebaseMessagingService\n  ) { }\n  canActivate(\n    next: ActivatedRouteSnapshot,\n    state: RouterStateSnapshot): Observable<boolean> | Promise<boolean> | boolean {\n    if(!this.platformService.is('ios') ) {\n      return true;\n    }\n    return this.unifiedNotificationService.hasPermission().then(res => {\n      if(res) {\n        return true;        \n      } else {\n        return this.dialogs.alert\n        (\n          'This app requires push notifications to work as intended.\\nYou can turn them silent any time you want.',\n          'Important'\n        )\n        .then(() => {\n          this.unifiedNotificationService.updatePermission();  \n          return true;\n        })\n        .catch(e => {\n          console.log(e);\n          return true;\n        });\n      }\n    });\n    return false;\n  }\n}\n","import { Component, OnInit } from '@angular/core';\n// import { Dialogs } from '@ionic-native/dialogs/ngx';\n\n@Component({\n  selector: 'lib-pey-unified-notifications',\n  template: `\n    <p>\n      pey-unified-notifications works!\n    </p>\n  `,\n  styles: []\n})\nexport class PeyUnifiedNotificationsComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n  // dialogMe() {\n    \n  //   this.dialogs.alert\n  //   (\n  //     '\\LOREM IPSUM MY DUDE\\nSSSS\\n!?'     \n  //   )\n  //   .catch(e => console.log(e));\n  // }\n}\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { PeyUnifiedNotificationsComponent } from './pey-unified-notifications.component';\nimport { Dialogs } from '@ionic-native/dialogs/ngx';\nimport { Firebase } from '@ionic-native/firebase/ngx';\n\n\n@NgModule({\n  declarations: [PeyUnifiedNotificationsComponent],\n  imports: [\n  ],\n  exports: [PeyUnifiedNotificationsComponent],\n  providers: [\n    Dialogs,\n    Firebase\n  ]\n})\nexport class PeyUnifiedNotificationsModule {  }"],"names":["BehaviorSubject","takeWhile","Injectable","Firebase","Platform","AngularFireMessaging","Dialogs","Component","NgModule"],"mappings":"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"}
